@import '../../style/utils/aspect-ratio.scss';
@import '../../style/utils/colors.scss';
@import '../../style/utils/cursors.scss';

@keyframes glitch {
  $steps: 10;
  @for $i from 0 through $steps{
    #{percentage($i * (1 / 100))} {
     $k: random(500);
     clip: rect($k + px, 9999px, $k + random(50) + px, 0);
     left: random(10) - 5%;
     transform: scale(1 + random(3)/10);
     filter: saturate(random(100) / 10);
     opacity: 1;
    }

    10.1% {
      clip: initial;
      left: 0;
      transform: initial;
      filter: initial;
      opacity: 0;
    }
  }
}

@keyframes transition {
  0% {
    transform: scale(1,0.8) translate3d(0,0,0);
    // -webkit-filter: brightness(30);
    // filter: brightness(30);
    opacity: 1;
  }

  29.166666667% {
    transform: scale(1,0.8) translate3d(0,100%,0);
  }

  30% {
    transform: scale(1,0.8) translate3d(0,-100%,0);
    opacity: 1;
  }

  75% {
    transform: scale(1.3,0.6) translate3d(0,100%,0);
    // -webkit-filter: brightness(30);
    // filter: brightness(30);
    opacity: 0;
  }

  91.666666667% {
    transform: scale(1,1) translate3d(0,0,0);
    -webkit-filter: contrast(0) brightness(0);
    filter: contrast(0) brightness(0);
    opacity: 0;
  }

  // to do
  100% {
    transform: scale(1,1) translate3d(0,0,0);
    -webkit-filter: contrast(1) brightness(1.2) saturate(1.3);
    filter: contrast(1) brightness(1.2) saturate(1.3);
    opacity: 1;
  }
}

@keyframes switch-on {
  0% {
    animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);;
    transform:scale(0.000,0.0001) translate3d(0,0,0);
    -moz-filter:brightness(50);
    -webkit-filter:brightness(50);
    filter:brightness(50);
  }

  40% {
    transform: scale(1.3,0.001) translate3d(0,0,0);
    -moz-filter:brightness(10);
    -webkit-filter:brightness(10);
    filter:brightness(10);
  }

  100% {
    transform: scale(1,1.3) translate3d(0,0,0);
    -moz-filter:brightness(1);
    -webkit-filter:brightness(1);
    filter:brightness(1);
    opacity:1;
  }
}

.screen {
  --color: #{$white};
  @include aspect-ratio(4, 3);
  background-color: $black;
  color: var(--color);
  position: relative;
  max-width: 60rem;
  margin: 1rem;
  overflow: hidden;
  cursor: $cursor_base;
  background-size: cover;
  background-position: center;

  &--no-interaction {
    cursor: none;
  }
}

.screen__glitch {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background-size: cover;
  background-position: center;
  animation: glitch 7s infinite step-end;
  animation-delay: 10s;
  pointer-events: none;
  z-index: 1;
  opacity: 0;
}

.screen__inner {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background-size: cover;
  background-position: center;

  &--is-switching-on {
    animation: switch-on 0.55s cubic-bezier(0.230, 1.000, 0.320, 1.000);;
    animation-fill-mode: backwards;
    pointer-events: none;
    cursor: none;
  }

  &--is-transitioning {
    animation: transition 240ms linear;
    animation-fill-mode: forwards;
    pointer-events: none;
    cursor: none;
  }
}

@keyframes flicker{
  $steps: 20;

  @for $i from 0 through $steps {
    #{percentage($i*(1/$steps))} {
      opacity:random();
    }
  }
}

// https://codepen.io/lbebber/pen/XJRdrV
// flicker
.screen__inner::after{
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: transparentize($black, 0.9);
  opacity: 0;
  z-index: 1002;
  pointer-events: none;
  animation: flicker 0.15s infinite;
}

.screen__inner::before{
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: linear-gradient(transparentize($black, 1) 50%, transparentize(darken($black, 10), 0.75) 50%), linear-gradient(90deg, transparentize(#ff0000, 0.94), transparentize(#00ff00, 0.98),transparentize(#0000ff, 0.94));
  z-index: 1002;
  background-size: 100% 2px, 3px 100%;
  pointer-events:none;
}

.screen .messages-feed__text-box {
  position: absolute;
  bottom: 1rem;
  left: 1rem;
  right: 1rem;
}
